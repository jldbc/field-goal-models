scaled
preds = nn.predict(nn2, testx)
testx
length(testx)
preds = nn.predict(nn2, testx)
game1
scaled = as.data.frame(scale(game1, center = mins, scale = maxs - mins))
preds = nn.predict(nn2, scaled)
shiny::runApp('Documents/field_goal_models/ShinyApp')
preds = nn.predict(nn2, scaled)
game1$pred <- preds
predsaa <- data.frame(game1$dist)
predsaa$preda <- predsaa
predsaa <- rename(predsaa, c("game1.dist"="dist"))
predsaa <- melt(predsaa, id="dist")
predsaa <- melt(predsaa, id="dist")
preds = nn.predict(nn2, scaled)
game1$pred <- preds
predsaa <- data.frame(game1$dist)
predsaa$preda <- preds
predsaa <- rename(predsaa, c("game1.dist"="dist"))
predsaa <- melt(predsaa, id="dist")
ggplot(data=predsaa,
aes(x=dist, y=value, colour=variable)) +
geom_point(size=5) + scale_x_continuous(limits = c(15, 75),breaks = round(seq(min(15), max(75), by = 5),1)) +
scale_y_continuous(limits = c(0, 1),breaks=round(seq(min(0), max(1), by=.05), 1)) +
scale_colour_manual(
values = c("preda" = "blue"),
breaks=c("Predicted Probability of Success")) +
theme(axis.text.x = element_text(face="bold",
size=16),  axis.text.y = element_text(face="bold", size=14),
axis.title.x = element_text(size=16,face="bold"),
axis.title.y = element_text(size=16,face="bold"))
shiny::runApp('Documents/field_goal_models/ShinyApp')
shiny::runApp('Documents/field_goal_models/ShinyApp')
shiny::runApp('Documents/field_goal_models/ShinyApp')
save("nn2" file="nn2.RData")
save("nn2", file="nn2.RData")
nn2 <- NULL
nn2 = load("nn2.RData")
nn2
nn2[0]
typeof(nn2)
nn2 <- nn.train(trainx, trainy, hidden = c(50, 50, 50), numepochs = 275)
save(nn2, file = "nn2.RData")
nn2 <- NULL
nn2
nn2 = load("nn2.RData")
nn2
nn2 <- nn.train(trainx, trainy, hidden = c(50, 50, 50), numepochs = 275)
ls()
save(nn2, file = "model.rda")
ls()
load("model.rda")
model
pwd
pwd()
ls
ls()
cd ..
pwd()
nn2
nn2 <- NULL
nn2
load("mymodel.rda")
load("model.rda")
nn2
save(scaled, file="scaleddata.rda")
scaled
scaled <- NULL
scaled
load("scaleddata.rda")
scaled
maxs
mins
save(maxs, file="maxs.rda")
save(minx, file="mins.rda")
save(mins, file="mins.rda")
shiny::runApp('Documents/field_goal_models/ShinyApp')
shiny::runApp('Documents/field_goal_models/ShinyApp')
load("model.rda")
load("scaleddata.rda")
load("maxs.rda")
load("mins.rda")
game1 <- data.frame(temp=tempVal, wspd=windVal, iced=icedval, turf=turfval,precip=precipval,mileHigh=altval,
k_AD0800=0, k_AE0700=0, k_AH2600=0, k_AP1000=0, k_AV0400=0, k_BC2300=0,
k_BC2600=0, k_BC3000=0, k_BD0100=0, k_BG1300=0, k_BW0350=0,k_CB0700=0,
k_CB1700=0, k_CH2900=0, k_CO0400=0, k_CS4000=0, k_CS4250=0, k_DA0300=0,
k_DB0200=0, k_DB3500=0, k_DB3900=0,k_DB5500=0, k_DC0500=0, k_DR0600=0,
k_EM2000=0, k_GA0300=0, k_GG0100=0, k_GH0600=0, k_GZ2000=0, k_HE0100=0,
k_JA2100=0, k_JB7100=0, k_JC0900=0, k_JC2100=0, k_JC5000=0, k_JE0200=0,
k_JF0800=0, k_JF0900=0, k_JH0400=0, k_JH0500=0, k_JH0900=0, k_JH3800=0,
k_JH5000=0, k_JJ1400=0, k_JK0200=0, k_JM4000=0, k_JN0600=0, k_JP3850=0,
k_JR1100=0, k_JS1100=0, k_JT1000=0, k_JT3950=0, k_JT4400=0, k_JW3300=0,
k_KB2300=0, k_KF0250=0, k_KH1500=0, k_LT1100=0, k_MA0700=0, k_MB4600=0,
k_MC3000=0, k_MG1200=0, k_MH3100=0, k_MH3900=0, k_MK1100=0, k_MK1200=0,
k_MN0800=0, k_MP2100=0, k_MS5200=0, k_MV0100=0, k_NF0300=0, k_NK0200=0,
k_NN0200=0, k_NR0100=0, k_OK0100=0, k_OM0100=0, k_OP0200=0, k_PD0200=0,
k_PE0100=0, k_PS0900=0, k_RB2200=0, k_RB4650=0, k_RC2900=0, k_RG1500=0,
k_RL0900=0, k_RL1300=0, k_RS0600=0, k_RS3400=0, k_SA1100=0, k_SB0500=0,
k_SC0700=0, k_SG0800=0, k_SG1100=0, k_SH0400=0, k_SJ0300=0, k_SL0400=0,
k_SL0600=0, k_SM0600=0, k_SS3100=0, k_TD2400=0, k_TF1200=0, k_TM2400=0,
k_TP1200=0, k_TS0500=0, k_TS1100=0, k_WR0500=0)
game1 <- data.frame(temp=0, wspd=0, iced=0, turf=0,precip=0,mileHigh=0,
k_AD0800=0, k_AE0700=0, k_AH2600=0, k_AP1000=0, k_AV0400=0, k_BC2300=0,
k_BC2600=0, k_BC3000=0, k_BD0100=0, k_BG1300=0, k_BW0350=0,k_CB0700=0,
k_CB1700=0, k_CH2900=0, k_CO0400=0, k_CS4000=0, k_CS4250=0, k_DA0300=0,
k_DB0200=0, k_DB3500=0, k_DB3900=0,k_DB5500=0, k_DC0500=0, k_DR0600=0,
k_EM2000=0, k_GA0300=0, k_GG0100=0, k_GH0600=0, k_GZ2000=0, k_HE0100=0,
k_JA2100=0, k_JB7100=0, k_JC0900=0, k_JC2100=0, k_JC5000=0, k_JE0200=0,
k_JF0800=0, k_JF0900=0, k_JH0400=0, k_JH0500=0, k_JH0900=0, k_JH3800=0,
k_JH5000=0, k_JJ1400=0, k_JK0200=0, k_JM4000=0, k_JN0600=0, k_JP3850=0,
k_JR1100=0, k_JS1100=0, k_JT1000=0, k_JT3950=0, k_JT4400=0, k_JW3300=0,
k_KB2300=0, k_KF0250=0, k_KH1500=0, k_LT1100=0, k_MA0700=0, k_MB4600=0,
k_MC3000=0, k_MG1200=0, k_MH3100=0, k_MH3900=0, k_MK1100=0, k_MK1200=0,
k_MN0800=0, k_MP2100=0, k_MS5200=0, k_MV0100=0, k_NF0300=0, k_NK0200=0,
k_NN0200=0, k_NR0100=0, k_OK0100=0, k_OM0100=0, k_OP0200=0, k_PD0200=0,
k_PE0100=0, k_PS0900=0, k_RB2200=0, k_RB4650=0, k_RC2900=0, k_RG1500=0,
k_RL0900=0, k_RL1300=0, k_RS0600=0, k_RS3400=0, k_SA1100=0, k_SB0500=0,
k_SC0700=0, k_SG0800=0, k_SG1100=0, k_SH0400=0, k_SJ0300=0, k_SL0400=0,
k_SL0600=0, k_SM0600=0, k_SS3100=0, k_TD2400=0, k_TF1200=0, k_TM2400=0,
k_TP1200=0, k_TS0500=0, k_TS1100=0, k_WR0500=0)
game1 <- game1[rep(seq_len(nrow(game1)), each=65),]
game1$dist<-seq.int(nrow(game1))
game1$dist<- input$dist
game1$dist<-19
scaled = as.data.frame(scale(game1, center = mins, scale = maxs - mins))
preds = nn.predict(nn2, scaled)
game1$pred <- preds
predsaa <- data.frame(game1$dist)
predsaa$preda <- preds
predsaa <- rename(predsaa, c("game1.dist"="dist"))
predsaa <- melt(predsaa, id="dist")
ggplot(data=predsaa,
aes(x=dist, y=value, colour=variable)) +
geom_point(size=5) + scale_x_continuous(limits = c(15, 75),breaks = round(seq(min(15), max(75), by = 5),1)) +
scale_y_continuous(limits = c(0, 1),breaks=round(seq(min(0), max(1), by=.05), 1)) +
scale_colour_manual(
values = c("preda" = "blue"),
breaks=c("Predicted Probability of Success")) +
theme(axis.text.x = element_text(face="bold",
size=16),  axis.text.y = element_text(face="bold", size=14),
axis.title.x = element_text(size=16,face="bold"),
axis.title.y = element_text(size=16,face="bold"))
shiny::runApp('Documents/field_goal_models/ShinyApp')
shiny::runApp('Documents/field_goal_models/ShinyApp')
value
predsaa
dat <- read.csv("Documents/Field_Goal_Models/imputed_kicker_data.csv")
library(ggplot2)
library(plyr)
#logistic regression models
#my favorite model (replication + iced)
fit1 <- glm(good ~ dist + cold + precip + windy + iced + turf + mileHigh , data=dat, family = "binomial")
summary(fit1)
summary(fit1)$coefficients
#exact replication (no iced)
fit2 <- glm(good ~ dist + cold + precip + windy + turf + mileHigh , data=dat, family = "binomial")
summary(fit2)
summary(fit2)$coefficients
#checking stadium significance
fitStadiums <- glm(good ~ dist + cold + precip + windy + iced + turf + mileHigh + Adelphia.Coliseum + Giants.Stadium  + Network.Associates.Coliseum + Paul.Brown.Stadium  + Ralph.Wilson.Stadium  +  Texas.Stadium + The.Meadowlands  + Veterans.Stadium , data=dat, family = "binomial")
summary(fitStadiums)
summary(fitStadiums)$coefficients
#show model's expected probabilities of kicks in data set
probability = predict(fit2, dat, type="response")
distance = dat$dist
qplot(x=distance, y=probability, color="red") + guides(colour=FALSE) +
scale_x_continuous(breaks = round(seq(min(15), max(dat$dist), by = 5),1)) +
scale_y_continuous(breaks=round(seq(min(0), max(1), by=.05), 1)) +
theme(axis.text.x = element_text(face="bold",
size=14),  axis.text.y = element_text(face="bold", size=14),
axis.title.x = element_text(size=16,face="bold"),
axis.title.y = element_text(size=16,face="bold"))
game1 <- data.frame(cold=1, precip=1, windy=1, iced=1, turf=0, mileHigh=0)
game1 <- game1[rep(seq_len(nrow(game1)), each=65),]
game1$dist<-seq.int(nrow(game1))
game2 <- data.frame(cold=0, precip=0, windy=0, iced=1, turf=0, mileHigh=0)
game2 <- game2[rep(seq_len(nrow(game2)), each=65),]
game2$dist<-seq.int(nrow(game2))
#non-iced model
predsa = predict(fit2, game1, type="response")
predsb = predict(fit2, game2, type="response")
game1$pred <- predsa
game2$pred <- predsb
predsaa <- data.frame(game1$dist)
predsaa$preda <- predsa
predsaa <- rename(predsaa, c("game1.dist"="dist"))
predsbb <- data.frame(game2$dist)
predsbb$predb <- predsb
predsbb <- rename(predsbb, c("game2.dist"="dist"))
predsaa$predb <- predsbb$predb
predsaa <- melt(predsaa, id="dist")
ggplot(data=predsaa,
aes(x=dist, y=value, colour=variable)) +
geom_line() + scale_x_continuous(limits = c(15, 65),breaks = round(seq(min(15), max(predsaa$dist), by = 5),1)) +
scale_y_continuous(breaks=round(seq(min(0), max(predsaa$value), by=.05), 1)) +
scale_colour_manual(
values = c("predb" = "red", "preda" = "blue"), labels = c("Game at OAK", "Game at NE"),
breaks=c("predb","preda")) +
theme(axis.text.x = element_text(face="bold",
size=14),  axis.text.y = element_text(face="bold", size=14),
axis.title.x = element_text(size=16,face="bold"),
axis.title.y = element_text(size=16,face="bold"))
predsaa
head(predsaa)
game1
ggplot(data=predsaa,
aes(x=dist, y=value, colour=variable)) +
geom_point(size=5) + scale_x_continuous(limits = c(15, 75),breaks = round(seq(min(15), max(75), by = 5),1)) +
scale_y_continuous(limits = c(0, 1),breaks=round(seq(min(0), max(1), by=.05), 1)) +
scale_colour_manual(
values = c("preda" = "blue"),
breaks=c("Predicted Probability of Success")) +
theme(axis.text.x = element_text(face="bold",
size=16),  axis.text.y = element_text(face="bold", size=14),
axis.title.x = element_text(size=16,face="bold"),
axis.title.y = element_text(size=16,face="bold"))
game2 <- data.frame(temp=50)
game2
game2 <- game2[rep(seq_len(nrow(game2)), each=65),]
game2
game2$dist<-seq.int(nrow(game2))
game2
game2 <- data.frame(temp=50, cold=0)
game2 <- game2[rep(seq_len(nrow(game2)), each=65),]
game2$dist<-seq.int(nrow(game2))
game2
head(scaled)
test = scaled[0]
test
test[][0]
scaled[][0]
game2 <- scaled
game2 <- game2[rep(seq_len(nrow(game2)), each=65),]
game2
length(game2$temp)
head(game2)
game2[row]
game2[1,]
game2 <- game2[1,]
game2 <- game2[rep(seq_len(nrow(game2)), each=65),]
game2
game2$dist<-seq.int(nrow(game2))
game2
load("model.rda")
#load scaled training data  -- called scaled
load("scaleddata.rda")
load("maxs.rda")
load("mins.rda")
setwd("~/Documents/field_goal_models/ShinyApp")
load("model.rda")
#load scaled training data  -- called scaled
load("scaleddata.rda")
load("maxs.rda")
load("mins.rda")
game1 <- data.frame(temp=44, wspd=2, iced=0, turf=1,precip=0,mileHigh=0,
k_AD0800=0, k_AE0700=0, k_AH2600=0, k_AP1000=0, k_AV0400=0, k_BC2300=0,
k_BC2600=0, k_BC3000=0, k_BD0100=0, k_BG1300=0, k_BW0350=0,k_CB0700=0,
k_CB1700=0, k_CH2900=0, k_CO0400=0, k_CS4000=0, k_CS4250=0, k_DA0300=0,
k_DB0200=0, k_DB3500=0, k_DB3900=0,k_DB5500=0, k_DC0500=0, k_DR0600=0,
k_EM2000=0, k_GA0300=0, k_GG0100=0, k_GH0600=0, k_GZ2000=0, k_HE0100=0,
k_JA2100=0, k_JB7100=0, k_JC0900=0, k_JC2100=0, k_JC5000=0, k_JE0200=0,
k_JF0800=0, k_JF0900=0, k_JH0400=0, k_JH0500=0, k_JH0900=0, k_JH3800=0,
k_JH5000=0, k_JJ1400=0, k_JK0200=0, k_JM4000=0, k_JN0600=0, k_JP3850=0,
k_JR1100=0, k_JS1100=0, k_JT1000=0, k_JT3950=0, k_JT4400=0, k_JW3300=0,
k_KB2300=0, k_KF0250=0, k_KH1500=0, k_LT1100=0, k_MA0700=0, k_MB4600=0,
k_MC3000=0, k_MG1200=0, k_MH3100=0, k_MH3900=0, k_MK1100=0, k_MK1200=0,
k_MN0800=0, k_MP2100=0, k_MS5200=0, k_MV0100=0, k_NF0300=0, k_NK0200=0,
k_NN0200=0, k_NR0100=0, k_OK0100=0, k_OM0100=0, k_OP0200=0, k_PD0200=0,
k_PE0100=0, k_PS0900=0, k_RB2200=1, k_RB4650=0, k_RC2900=0, k_RG1500=0,
k_RL0900=0, k_RL1300=0, k_RS0600=0, k_RS3400=0, k_SA1100=0, k_SB0500=0,
k_SC0700=0, k_SG0800=0, k_SG1100=0, k_SH0400=0, k_SJ0300=0, k_SL0400=0,
k_SL0600=0, k_SM0600=0, k_SS3100=0, k_TD2400=0, k_TF1200=0, k_TM2400=0,
k_TP1200=0, k_TS0500=0, k_TS1100=0, k_WR0500=0)
game1 <- game1[rep(seq_len(nrow(game1)), each=65),]
game1$dist<-seq.int(nrow(game1))
game1$dist<-45
scaled = as.data.frame(scale(game1, center = mins, scale = maxs - mins))
preds = nn.predict(nn2, scaled)
game1$pred <- preds
predsaa <- data.frame(game1$dist)
predsaa$preda <- preds
game2 <- game1
game2 <- game2[1,]
game2 <- game2[rep(seq_len(nrow(game2)), each=65),]
game2$dist<-seq.int(nrow(game2))
head(game2)
scaled2 = as.data.frame(scale(game2, center = mins, scale = maxs - mins))
predsb = nn.predict(nn2, scaled2)
length(game2)
length(maxs)
head(game2)
game2$pred <- NULL
scaled2 = as.data.frame(scale(game2, center = mins, scale = maxs - mins))
predsb = nn.predict(nn2, scaled2)
predsbb <- data.frame(game2$dist)
predsbb$predb <- predsb
predsbb <- rename(predsbb, c("game2.dist"="dist"))
head(predsbb)
predsbb$predb <- predsbb$predb
head(predsaa)
predsaa
predsaa <- rbind(predsaa, predsbb)
head(predsaa)
predsbb <- data.frame(game2$dist)
predsbb$preda <- predsb
predsbb <- rename(predsbb, c("game2.dist"="dist"))
head(predsbb)
predsaa <- rbind(predsaa, predsbb)
head(predsaa)
predsaa <- rename(predsaa, c("game1.dist"="dist"))
predsaa <- rbind(predsaa, predsbb)
head(predsaa)
predsaa
predsaa <- melt(predsaa, id="dist")
predsaa
ggplot(data=predsaa,
aes(x=dist, y=value, colour=variable)) + geom_line() +
geom_point(size=5) + scale_x_continuous(limits = c(15, 75),breaks = round(seq(min(15), max(75), by = 5),1)) +
scale_y_continuous(limits = c(0, 1),breaks=round(seq(min(0), max(1), by=.05), 1)) +
scale_colour_manual(
values = c("preda" = "blue"),
breaks=c("Predicted Probability of Success")) +
theme(axis.text.x = element_text(face="bold",
size=16),  axis.text.y = element_text(face="bold", size=14),
axis.title.x = element_text(size=16,face="bold"),
axis.title.y = element_text(size=16,face="bold"))
ggplot(data=predsaa,
aes(x=dist, y=value, colour=variable)) + geom_line() +
geom_point(size=5, subset = .(dist == input$dist)) + scale_x_continuous(limits = c(15, 75),breaks = round(seq(min(15), max(75), by = 5),1)) +
scale_y_continuous(limits = c(0, 1),breaks=round(seq(min(0), max(1), by=.05), 1)) +
scale_colour_manual(
values = c("preda" = "blue"),
breaks=c("Predicted Probability of Success")) +
theme(axis.text.x = element_text(face="bold",
size=16),  axis.text.y = element_text(face="bold", size=14),
axis.title.x = element_text(size=16,face="bold"),
axis.title.y = element_text(size=16,face="bold"))
ggplot(data=predsaa,
aes(x=dist, y=value, colour=variable)) + geom_line() +
geom_point(size=5, subset = (predsaa$dist == input$dist)) + scale_x_continuous(limits = c(15, 75),breaks = round(seq(min(15), max(75), by = 5),1)) +
scale_y_continuous(limits = c(0, 1),breaks=round(seq(min(0), max(1), by=.05), 1)) +
scale_colour_manual(
values = c("preda" = "blue"),
breaks=c("Predicted Probability of Success")) +
theme(axis.text.x = element_text(face="bold",
size=16),  axis.text.y = element_text(face="bold", size=14),
axis.title.x = element_text(size=16,face="bold"),
axis.title.y = element_text(size=16,face="bold"))
ggplot(data=predsaa,
aes(x=dist, y=value, colour=variable)) + geom_line() +
geom_point(size=5, subset = (predsaa$dist == 45t)) + scale_x_continuous(limits = c(15, 75),breaks = round(seq(min(15), max(75), by = 5),1)) +
scale_y_continuous(limits = c(0, 1),breaks=round(seq(min(0), max(1), by=.05), 1)) +
scale_colour_manual(
values = c("preda" = "blue"),
breaks=c("Predicted Probability of Success")) +
theme(axis.text.x = element_text(face="bold",
size=16),  axis.text.y = element_text(face="bold", size=14),
axis.title.x = element_text(size=16,face="bold"),
axis.title.y = element_text(size=16,face="bold"))
ggplot(data=predsaa,
aes(x=dist, y=value, colour=variable)) + geom_line() +
geom_point(size=5, subset = (predsaa$dist == 45)) + scale_x_continuous(limits = c(15, 75),breaks = round(seq(min(15), max(75), by = 5),1)) +
scale_y_continuous(limits = c(0, 1),breaks=round(seq(min(0), max(1), by=.05), 1)) +
scale_colour_manual(
values = c("preda" = "blue"),
breaks=c("Predicted Probability of Success")) +
theme(axis.text.x = element_text(face="bold",
size=16),  axis.text.y = element_text(face="bold", size=14),
axis.title.x = element_text(size=16,face="bold"),
axis.title.y = element_text(size=16,face="bold"))
ggplot(data=predsaa,
aes(x=dist, y=value, colour=variable)) + geom_line() +
geom_point(size=5, x=predsaa[predsaa$dist==45], y=value) + scale_x_continuous(limits = c(15, 75),breaks = round(seq(min(15), max(75), by = 5),1)) +
scale_y_continuous(limits = c(0, 1),breaks=round(seq(min(0), max(1), by=.05), 1)) +
scale_colour_manual(
values = c("preda" = "blue"),
breaks=c("Predicted Probability of Success")) +
theme(axis.text.x = element_text(face="bold",
size=16),  axis.text.y = element_text(face="bold", size=14),
axis.title.x = element_text(size=16,face="bold"),
axis.title.y = element_text(size=16,face="bold"))
ggplot(data=predsaa,
aes(x=dist, y=value, colour=variable)) + geom_line() +
geom_point(size=5, x=45, y=value) + scale_x_continuous(limits = c(15, 75),breaks = round(seq(min(15), max(75), by = 5),1)) +
scale_y_continuous(limits = c(0, 1),breaks=round(seq(min(0), max(1), by=.05), 1)) +
scale_colour_manual(
values = c("preda" = "blue"),
breaks=c("Predicted Probability of Success")) +
theme(axis.text.x = element_text(face="bold",
size=16),  axis.text.y = element_text(face="bold", size=14),
axis.title.x = element_text(size=16,face="bold"),
axis.title.y = element_text(size=16,face="bold"))
ggplot(data=predsaa,
aes(x=dist, y=value, colour=variable)) + geom_line() +
geom_point(size=5, x=45, y=.6) + scale_x_continuous(limits = c(15, 75),breaks = round(seq(min(15), max(75), by = 5),1)) +
scale_y_continuous(limits = c(0, 1),breaks=round(seq(min(0), max(1), by=.05), 1)) +
scale_colour_manual(
values = c("preda" = "blue"),
breaks=c("Predicted Probability of Success")) +
theme(axis.text.x = element_text(face="bold",
size=16),  axis.text.y = element_text(face="bold", size=14),
axis.title.x = element_text(size=16,face="bold"),
axis.title.y = element_text(size=16,face="bold"))
ggplot(data=predsaa,
aes(x=dist, y=value, colour=variable)) + geom_line() +
geom_point(size=5, x=45, y=predsaa$value[predsaa$dist == 45]) + scale_x_continuous(limits = c(15, 75),breaks = round(seq(min(15), max(75), by = 5),1)) +
scale_y_continuous(limits = c(0, 1),breaks=round(seq(min(0), max(1), by=.05), 1)) +
scale_colour_manual(
values = c("preda" = "blue"),
breaks=c("Predicted Probability of Success")) +
theme(axis.text.x = element_text(face="bold",
size=16),  axis.text.y = element_text(face="bold", size=14),
axis.title.x = element_text(size=16,face="bold"),
axis.title.y = element_text(size=16,face="bold"))
predsaa$value[predsaa$dist == 45]
predsaa$value[predsaa$dist == 45][1,]
predsaa$value[predsaa$dist == 45][1]
predsaa$value[predsaa$dist == 45]
ggplot(data=predsaa,
aes(x=dist, y=value, colour=variable)) + geom_line() +
geom_point(size=5, x=45, y=predsaa$value[predsaa$dist == 45][1]) + scale_x_continuous(limits = c(15, 75),breaks = round(seq(min(15), max(75), by = 5),1)) +
scale_y_continuous(limits = c(0, 1),breaks=round(seq(min(0), max(1), by=.05), 1)) +
scale_colour_manual(
values = c("preda" = "blue"),
breaks=c("Predicted Probability of Success")) +
theme(axis.text.x = element_text(face="bold",
size=16),  axis.text.y = element_text(face="bold", size=14),
axis.title.x = element_text(size=16,face="bold"),
axis.title.y = element_text(size=16,face="bold"))
shiny::runApp()
shiny::runApp()
shiny::runApp()
game1 <- data.frame(cold=1, precip=1, windy=1, iced=1, turf=0, mileHigh=0)
game1 <- game1[rep(seq_len(nrow(game1)), each=65),]
game1$dist<-seq.int(nrow(game1))
game2 <- data.frame(cold=0, precip=0, windy=0, iced=1, turf=0, mileHigh=0)
game2 <- game2[rep(seq_len(nrow(game2)), each=65),]
game2$dist<-seq.int(nrow(game2))
#non-iced model
predsa = predict(fit2, game1, type="response")
predsb = predict(fit2, game2, type="response")
game1$pred <- predsa
game2$pred <- predsb
predsaa <- data.frame(game1$dist)
predsaa$preda <- predsa
predsaa <- rename(predsaa, c("game1.dist"="dist"))
predsbb <- data.frame(game2$dist)
predsbb$predb <- predsb
predsbb <- rename(predsbb, c("game2.dist"="dist"))
predsaa$predb <- predsbb$predb
predsaa <- melt(predsaa, id="dist")
ggplot(data=predsaa,
aes(x=dist, y=value, colour=variable)) +
geom_line() + scale_x_continuous(limits = c(15, 65),breaks = round(seq(min(15), max(predsaa$dist), by = 5),1)) +
scale_y_continuous(breaks=round(seq(min(0), max(predsaa$value), by=.05), 1)) +
scale_colour_manual(
values = c("predb" = "red", "preda" = "blue"), labels = c("Game at OAK", "Game at NE"),
breaks=c("predb","preda")) +
theme(axis.text.x = element_text(face="bold",
size=14),  axis.text.y = element_text(face="bold", size=14),
axis.title.x = element_text(size=16,face="bold"),
axis.title.y = element_text(size=16,face="bold"))
shiny::runApp()
shiny::runApp()
shiny::runApp()
shiny::runApp()
shiny::runApp()
shiny::runApp()
shiny::runApp()
shiny::runApp()
shiny::runApp()
shiny::runApp()
shiny::runApp()
shiny::runApp()
shiny::runApp()
shiny::runApp()
shiny::runApp()
shiny::runApp()
sidebarPanel
shiny::runApp()
shiny::runApp()
shiny::runApp()
shiny::runApp()
shiny::runApp()
shiny::runApp()
shiny::runApp()
shiny::runApp()
shiny::runApp()
shiny::runApp()
shiny::runApp()
shiny::runApp()
shiny::runApp()
shiny::runApp()
shiny::runApp()
shiny::runApp()
shiny::runApp()
shiny::runApp()
shiny::runApp()
shiny::runApp()
shiny::runApp()
shiny::runApp()
shiny::runApp()
shiny::runApp()
shiny::runApp()
shiny::runApp()
shiny::runApp()
shiny::runApp()
shiny::runApp()
shiny::runApp()
shiny::runApp()
